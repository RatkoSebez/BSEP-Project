<app-menu></app-menu>

<div class="row justify-content-center">
    <div class="col-auto mt-3">
        <button class="btn btn-outline-success" type="button" data-bs-toggle="modal" data-bs-target="#createRootCaModal" *ngIf="user.role == 'ROLE_ADMIN'">Create
            root CA</button>
        <button class="btn btn-outline-success" type="button" data-bs-toggle="modal" data-bs-target="#createCaModal">Create
            CA</button>
        <button class="btn btn-outline-success" type="button" data-bs-toggle="modal" data-bs-target="#createEndEntityCertificate">Create
            End Entity Certificate</button>
        <table class="table table-secondary table-striped w-auto mt-3" *ngIf="user.role == 'ROLE_ADMIN'">
            <thead>
                <tr>
                    <th scope="col">User id</th>
                    <th scope="col">Username</th>
                    <th scope="col">First Name</th>
                    <th scope="col">Last Name</th>
                    <th scope="col">Role</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let user of users">
                    <th scope="row">{{ user.id }}</th>
                    <td>{{ user.username }}</td>
                    <td>{{ user.firstName }}</td>
                    <td>{{ user.lastName }}</td>
                    <td>{{ user.role }}</td>
                </tr>
            </tbody>
        </table>
    </div>
</div>

<!-- Create root ca modal -->
<div class="modal fade" id="createRootCaModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Create root certificate authority</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <label for="">Select user id</label>
                <select class="form-select" aria-label="Floating label select example" [(ngModel)]="ownerId">
                    <option *ngFor="let user of users" value={{user.id}}>{{user.id}}</option>
                </select>
                <!-- <input class="form-control mb-4" type="text" placeholder="owner id" name="owner id" [(ngModel)]="ownerId"> -->
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button type="submit" class="btn btn-primary" data-bs-dismiss="modal" (click)="createRootCa()">Submit</button>
            </div>
        </div>
    </div>
</div>

<!-- Create ca modal -->
<div class="modal fade" id="createCaModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Create certificate authority</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <label for="" *ngIf="user.role == 'ROLE_ADMIN'">Select user id</label>
                <select class="form-select" aria-label="Floating label select example" [(ngModel)]="ownerId" *ngIf="user.role == 'ROLE_ADMIN'">
                    <option *ngFor="let user of users" value={{user.id}}>{{user.id}}</option>
                </select>
                <!-- <input class="form-control mb-4" type="text" placeholder="owner id" name="owner id"
                    [(ngModel)]="ownerId"> -->
                <label for="">Certificate publisher id</label>
                <select class="form-select" aria-label="Floating label select example" [(ngModel)]="idOfCertificatePublisher">
                    <option *ngFor="let ca of certificateAuthorities" value={{ca.id}}>{{ca.id}}</option>
                </select>
                <!-- <input class="form-control mb-4" type="text" placeholder="idOfCertificatePublisher"
                    name="idOfCertificatePublisher" [(ngModel)]="idOfCertificatePublisher"> -->
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button type="submit" class="btn btn-primary" data-bs-dismiss="modal" (click)="createCa()">Submit</button>
            </div>
        </div>
    </div>
</div>

<!-- Create end entity certificate modal -->
<div class="modal fade" id="createEndEntityCertificate" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Create end entity certificate</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <label for="" *ngIf="user.role == 'ROLE_ADMIN'">Select user id</label>
                <select class="form-select" aria-label="Floating label select example" [(ngModel)]="ownerId"
                    *ngIf="user.role == 'ROLE_ADMIN'">
                    <option *ngFor="let user of users" value={{user.id}}>{{user.id}}</option>
                </select>
                <label for="">Certificate publisher id</label>
                <select class="form-select" aria-label="Floating label select example" [(ngModel)]="idOfCertificatePublisher">
                    <option *ngFor="let ca of certificateAuthorities" value={{ca.id}}>{{ca.id}}</option>
                </select>
                <!-- <input class="form-control mb-4" type="text" placeholder="owner id" name="owner id"
                    [(ngModel)]="ownerId">
                <input class="form-control mb-4" type="text" placeholder="idOfCertificatePublisher" name="idOfCertificatePublisher"
                    [(ngModel)]="idOfCertificatePublisher"> -->
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button type="submit" class="btn btn-primary" data-bs-dismiss="modal"
                    (click)="createEndEntityCertificate()">Submit</button>
            </div>
        </div>
    </div>
</div>
